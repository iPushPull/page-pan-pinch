!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.pagepanpinch=e():t.pagepanpinch=e()}(this,function(){return function(t){function e(n){if(s[n])return s[n].exports;var o=s[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var s={};return e.m=t,e.c=s,e.d=function(t,s,n){e.o(t,s)||Object.defineProperty(t,s,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var s=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(s,"a",s),s},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,s){t.exports=s(1)},function(t,e){var s=function(){function t(t){var e=this;if(this.version="0.15",this._options={prefix:"ppp",bounds:"",contentView:"",contentScroll:"",contentZoom:"",page:"",pageHasChildren:!1,debug:"",zoomCss:!1,zoomIncrements:.25,zoomFit:!0,scrollBars:!1,scrollBarWidth:8,scrollBarsInset:!1,disablePan:!1,onTap:function(t,e){},onDoubleTap:function(t,e){}},this._scrollBars=!1,this._scale={last:1,current:1,min:.5,max:2,width:0,height:0},this._pos={friction:.8,updateInterval:50,x:{last:0,current:0,vel:0,delta:0},y:{last:0,current:0,vel:0,delta:0}},this._scrollBarElements={scrollX:{axis:"x",element:null,type:"scroller",className:"scroll-x",zIndex:100,drag:!1,pos:{}},scrollY:{axis:"y",element:null,type:"scroller",className:"scroll-y",zIndex:100,drag:!1,pos:{}},trackX:{axis:"x",element:null,type:"track",className:"track-x",zIndex:10,pos:{}},trackY:{axis:"y",element:null,type:"track",className:"track-y",zIndex:10,pos:{}}},this._scrollParams={x:{parent:"trackX",element:"scrollX",pos:"mouseX",unit:"width",dir:"left"},y:{parent:"trackY",element:"scrollY",pos:"mouseY",unit:"height",dir:"top"}},this._scrollEvents=!1,this._isScrolling=!1,this._init=!1,this._initScale=!1,this.initInterval=function(){e._options.pageHasChildren&&!e._page.childNodes.length||(clearInterval(e._initInterval),e._initInterval=void 0,e.setupContainers(),e._initScale&&e.setMaxMinScale(),e.setupScrollbars(),e.setupTouch(),e.update(),e._initScale&&e.updateContentScroll(),e._init=!0)},this._eventScroll=function(t){e._isScrolling||(e._pos.x.current=e._contentView.scrollLeft,e._pos.y.current=e._contentView.scrollTop,e.update())},this._eventScrollWheel=function(t){if(e._scrollBars&&e._scrollEvents){e._isScrolling=!0,e._eventScrollWheelTimer&&(clearTimeout(e._eventScrollWheelTimer),e._eventScrollWheelTimer=void 0);var s=Math.max(-1,Math.min(1,t.wheelDelta||-t.detail)),n=e._scrollEvents.indexOf("y")>-1?"y":"x",o=e._scrollParams[n].dir.charAt(0).toUpperCase()+e._scrollParams[n].dir.slice(1),i="scroll"+o;e._pos[n].current+=20*s*-1,e.update(),e._pos[n].current=e._pos[n].last=e._contentView[i],e._eventScrollWheelTimer=setTimeout(function(){e._isScrolling=!1},50),t.preventDefault()}},this._eventScrollMouseMove=function(t){e._isScrolling=!0;for(var s in e._scrollBarElements)if(e._scrollBarElements.hasOwnProperty(s)){var n=e._scrollBarElements[s];if(!0===n.drag){var o=e._scrollParams[n.axis],i=t[n.axis]-n.pos[o.pos],l=n.pos[n.axis]+i;l<0&&(l=0);var r=parseFloat(n.element.style[o.unit]),c=e._scrollBounds[o.unit]-r,a=e._scrollBounds[o.dir]+c;l>a&&(l=a);var h=l;e._pos[n.axis].current=e._pos[n.axis].last=h*(e._scrollRect[o.unit]/e._scrollBounds[o.unit]),e.update(),console.log("mouse","pos",l,"distance",r,"scroll",h)}}},this._eventScrollMouseUp=function(t){e._isScrolling=!1;for(var s in e._scrollBarElements)e._scrollBarElements.hasOwnProperty(s)&&(e._scrollBarElements[s].drag=!1)},this._eventPinchStart=function(t){e._scale.last=e._scale.current,e.clearPanTimer(),e.updateContentScroll()},this._eventPinchMove=function(t){e._scale.current=e._scale.last*t.scale,e.update()},this._eventPinchEnd=function(t){e._scale.last=e._scale.current,e.update(),e.updateContentScroll()},this._eventTap=function(t){1===t.tapCount?e._options.onTap(e,t):2===t.tapCount&&e._options.onDoubleTap(e,t)},this._eventPanStart=function(t){e._scale.last=e._scale.current,e.clearPanTimer(),e.updateContentScroll()},this._eventPanMove=function(t){e._pos.x.current=e._pos.x.last+-1*t.deltaX,e._pos.y.current=e._pos.y.last+-1*t.deltaY,e.update()},this._eventPanEnd=function(t){e._pos.x.last=e._pos.x.current,e._pos.y.last=e._pos.y.current,e._pos.x.delta=-1*t.deltaX,e._pos.y.delta=-1*t.deltaY,Math.abs(t.velocity)>.2&&(e._panTimer=setInterval(function(){e.updatePanVel()},e._pos.updateInterval))},void 0===window.Hammer)throw"Hammer JS not found";for(var s in t)t.hasOwnProperty(s)&&(this._options[s]=t[s]);if(this._bounds="string"==typeof this._options.bounds?document.getElementById(this._options.bounds):this._options.bounds,this._contentView="string"==typeof this._options.contentView?document.getElementById(this._options.contentView):this._options.contentView,this._contentScroll="string"==typeof this._options.contentScroll?document.getElementById(this._options.contentScroll):this._options.contentScroll,this._contentZoom="string"==typeof this._options.contentZoom?document.getElementById(this._options.contentZoom):this._options.contentZoom,this._page="string"==typeof this._options.page?document.getElementById(this._options.page):this._options.page,this._debug="string"==typeof this._options.debug?document.getElementById(this._options.debug):this._options.debug,!(this._contentView&&this._bounds&&this._contentScroll&&this._contentZoom&&this._page))throw"DOM Elements undefined";this.init(this._options.zoomFit)}return t.prototype.init=function(t){this._init=!1,this._initInterval=setInterval(this.initInterval,10),this._initScale=t,this.initInterval()},t.prototype.refresh=function(){this.destroy(),this.init(this._options.zoomFit)},t.prototype.zoom=function(t){"in"===t?this._scale.current+=this._options.zoomIncrements:this._scale.current-=this._options.zoomIncrements,this._scale.last=this._scale.current,this.update()},t.prototype.zoomFit=function(t){this._options.zoomFit=t,t||(this._scale.last=this._scale.current=1,this._scale.max=2,this._scale.min=.5,this._scrollBars=!0),this.refresh()},t.prototype.destroy=function(){try{window.removeEventListener("mousemove",this._eventScrollMouseMove,!1),window.removeEventListener("mouseup",this._eventScrollMouseMove,!1),this._contentView.removeEventListener("mousewheel",this._eventScrollWheel,!1),this._contentView.removeEventListener("scroll",this._eventScroll,!1),this._scrollEvents=!1}catch(t){}try{this._scrollContainer&&(this._scrollContainer.parentNode.removeChild(this._scrollContainer),this._scrollContainer=void 0)}catch(t){}},t.prototype.setupScrollbars=function(){var t=this;if(this._scrollBars=!1,"contain"!==this._options.zoomFit&&!0!==this._options.zoomFit&&this._options.scrollBars&&(this._scrollBounds=this.getBoundingClientRect(this._contentView.getBoundingClientRect()),this._scrollRect=this.getBoundingClientRect(this._contentScroll.getBoundingClientRect()),this._scrollRect.height=this._scrollRect.height*this._scale.current,this._scrollRect.width=this._scrollRect.width*this._scale.current,(this._scrollBounds.height<this._scrollRect.height||this._scrollBounds.width<this._scrollRect.width)&&(this._scrollBars=!0),this._scrollBars)){var e=[];this._scrollBounds.height<this._scrollRect.height&&e.push("y"),this._scrollBounds.width<this._scrollRect.width&&e.push("x"),this._scrollEvents=e;var s=this;for(var n in this._scrollBarElements)!function(n){if(!s._scrollBarElements.hasOwnProperty(n))return"continue";var o=s._scrollBarElements[n].axis,i=document.createElement("div");i.className=s._options.prefix+" "+s._options.prefix+"-"+s._scrollBarElements[n].className,i.style.position="absolute",i.style.zIndex=s._scrollBarElements[n].zIndex,i.addEventListener("mousedown",function(e){"scroller"===t._scrollBarElements[n].type?(t._scrollBarElements[n].pos.mouseX=e.x,t._scrollBarElements[n].pos.mouseY=e.y,t._scrollBarElements[n].pos.x=parseFloat(t._scrollBarElements[n].element.style.left),t._scrollBarElements[n].pos.y=parseFloat(t._scrollBarElements[n].element.style.top),t._scrollBarElements[n].drag=!0,e.stopPropagation()):t.onClickScrollbar(t._scrollBarElements[n],e)}),s._scrollBarElements[n].element=i;var l=-1!==e.indexOf(o)?s._options.prefix+"-show":s._options.prefix+"-hide";i.className=s.removeClassname(i.className,s._options.prefix+"-show"),i.className=s.removeClassname(i.className,s._options.prefix+"-hide"),i.className=s.addClassname(i.className,l);var r=0;switch(s._options.scrollBarsInset&&(r=s._options.scrollBarWidth),s._scrollBarElements[n].type){case"scroller":var c=Math.floor(s._scrollBounds.width/s._scrollRect.width*s._scrollBounds.width),a=Math.floor(s._scrollBounds.height/s._scrollRect.height*s._scrollBounds.height);-1===e.indexOf("x")&&(c=0),-1===e.indexOf("y")&&(a=0),s._scrollBarElements[n].length="x"===o?c:a,i.style.left="0px",i.style.top="0px",i.style.width="x"===o?c+"px":s._options.scrollBarWidth+"px",i.style.height="x"===o?s._options.scrollBarWidth+"px":a+"px";break;default:"x"===o?(i.style.left=s._contentView.offsetLeft+"px",i.style.top=s._contentView.offsetTop+s._scrollBounds.height+r+"px"):(i.style.left=s._contentView.offsetLeft+s._scrollBounds.width+r+"px",i.style.top=s._contentView.offsetTop+"px"),i.style.width="x"===o?s._scrollBounds.width+"px":s._options.scrollBarWidth+"px",i.style.height="x"===o?s._options.scrollBarWidth+"px":s._scrollBounds.height+"px"}}(n);this._scrollContainer||(this._scrollContainer=document.createElement("div"),this._scrollBarElements.trackX.element.appendChild(this._scrollBarElements.scrollX.element),this._scrollBarElements.trackY.element.appendChild(this._scrollBarElements.scrollY.element),this._scrollContainer.appendChild(this._scrollBarElements.trackX.element),this._scrollContainer.appendChild(this._scrollBarElements.trackY.element)),this._bounds.appendChild(this._scrollContainer),window.addEventListener("mousemove",this._eventScrollMouseMove,!1),window.addEventListener("mouseup",this._eventScrollMouseUp,!1),this._contentView.addEventListener("mousewheel",this._eventScrollWheel,!1)}},t.prototype.setupContainers=function(){this._contentView.style.overflow="hidden",this._contentView.addEventListener("scroll",this._eventScroll,!1),this._contentScroll.style.width=this._page.clientWidth+"px",this._contentScroll.style.height=this._page.clientHeight+"px",this._contentZoom.style.transformOrigin="0 0"},t.prototype.setupTouch=function(){this._mc&&this._mc.destroy(),this._mc=new Hammer(this._contentView);var t=new Hammer.Pan,e=new Hammer.Tap({event:"singletap"}),s=new Hammer.Tap({event:"doubletap",taps:2});s.recognizeWith(e);var n=new Hammer.Pinch;this._mc.add([t,s,n]),this._scrollEvents||(this._mc.on("pinchstart",this._eventPinchStart),this._mc.on("pinchmove",this._eventPinchMove),this._mc.on("pinchend",this._eventPinchEnd)),this._mc.on("tap",this._eventTap),this._options.disablePan||(this._mc.on("panstart",this._eventPanStart),this._mc.on("panmove",this._eventPanMove),this._mc.on("panend",this._eventPanEnd))},t.prototype.onClickScrollbar=function(t,e){console.log("onClickScrollbar",e);var s=this._scrollBarElements["scroll"+t.axis.toUpperCase()],n=this._scrollParams[t.axis],o=parseFloat(s.element.style[n.dir])+s.length,i=e[t.axis]>o;this._pos[t.axis].current=this._pos[t.axis].last=i?this._scrollRect[n.unit]-this._scrollBounds[n.unit]:0,this.update()},t.prototype.clearPanTimer=function(){this._panTimer&&clearInterval(this._panTimer)},t.prototype.updatePanVel=function(){this._pos.x.current+=this._pos.x.delta,this._pos.y.current+=this._pos.y.delta,this._pos.x.last=this._pos.x.current,this._pos.y.last=this._pos.y.current,this._pos.x.delta*=this._pos.friction,this._pos.y.delta*=this._pos.friction,this.update(),Math.abs(this._pos.x.delta)<.01&&Math.abs(this._pos.y.delta)<.01&&clearInterval(this._panTimer)},t.prototype.update=function(){this.setWithinBounds(),this._contentView.scrollLeft=this._pos.x.current,this._contentView.scrollTop=this._pos.y.current,this._contentZoom.style.transform=this._options.zoomCss?"translateZ(0px)":"translateZ(0px) scale("+this._scale.current+")",this._options.zoomCss&&(this._contentZoom.style.zoom=100*this._scale.current+"%"),this.updateScrollbars()},t.prototype.updateScrollbars=function(){if(this._scrollBars&&this._scrollEvents)for(var t in this._scrollParams)if(this._scrollParams.hasOwnProperty(t)){var e=this._scrollParams[t],s=this._scrollRect[e.unit]-this._scrollBounds[e.unit],n=this._scrollBounds[e.unit]-this._scrollBarElements[e.element].length,o=this._pos[t].current*n/s;this._scrollBarElements[e.element].element.style[e.dir]=o+"px"}},t.prototype.updateContentScroll=function(){this._contentScroll.style.width=Math.ceil(this._scale.width)+"px",this._contentScroll.style.height=Math.ceil(this._scale.height)+"px"},t.prototype.setMaxMinScale=function(t){var e=this._contentView.clientWidth/this._page.clientWidth,s=this._contentView.clientHeight/this._page.clientHeight,n=s<e?s:e;"width"===this._options.zoomFit&&(n=e),"height"===this._options.zoomFit&&(n=s),this._scale.last=this._scale.current=n,this._scale.min=n,this._scale.max=n<1?2:2*n},t.prototype.setWithinBounds=function(){this._scale.current>this._scale.max&&(this._scale.current=this._scale.max),this._scale.current<this._scale.min&&(this._scale.current=this._scale.min);var t=this._page.clientWidth*this._scale.current,e=this._page.clientHeight*this._scale.current;this._scale.width=t,this._scale.height=e;var s=t-this._contentView.clientWidth,n=e-this._contentView.clientHeight;this._pos.x.max=s,this._pos.x.min=0,this._pos.y.max=n,this._pos.y.min=0,t>this._contentView.clientWidth?this._pos.x.current>s?this._pos.x.current=s:this._pos.x.current<0&&(this._pos.x.current=0):this._pos.x.current=0,e>this._contentView.clientHeight?this._pos.y.current>n?this._pos.y.current=n:this._pos.y.current<0&&(this._pos.y.current=0):this._pos.y.current=0,this._debug&&(this._debug.innerHTML='\n                <table>\n                    <tr>\n                        <td width="100">x</td>\n                        <td align="right">'+this._pos.x.current.toFixed(2)+'</td>\n                    </tr>\n                    <tr>\n                        <td>y</td>\n                        <td align="right">'+this._pos.y.current.toFixed(2)+'</td>\n                    </tr>\n                    <tr>\n                        <td>width</td>\n                        <td align="right">'+t.toFixed(2)+'</td>\n                    </tr>\n                    <tr>\n                        <td>height</td>\n                        <td align="right">'+e.toFixed(2)+'</td>\n                    </tr>\n                    <tr>\n                        <td>scale</td>\n                        <td align="right">'+this._scale.last.toFixed(2)+'</td>\n                    </tr>\n                    <tr>\n                        <td>bounds height</td>\n                        <td align="right">'+this._contentView.clientHeight.toFixed(2)+'</td>\n                    </tr>\n                    <tr>\n                        <td>bounds width</td>\n                        <td align="right">'+this._contentView.clientWidth.toFixed(2)+'</td>\n                    </tr>\n                    <tr>\n                        <td>page height</td>\n                        <td align="right">'+this._page.clientHeight.toFixed(2)+'</td>\n                    </tr>\n                    <tr>\n                        <td>page width</td>\n                        <td align="right">'+this._page.clientWidth.toFixed(2)+"</td>\n                    </tr>\n                </table>\n            ")},t.prototype.addClassname=function(t,e){return(this.removeClassname(t,e)+" "+e).trim()},t.prototype.removeClassname=function(t,e){var s=new RegExp(""+e,"ig");return t.replace(s,"").trim()},t.prototype.getBoundingClientRect=function(t){return{top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.width,height:t.height,x:t.x,y:t.y}},t}(),n=function(t){return new s(t)};t.exports=n,t.exports.defaults=n}])});